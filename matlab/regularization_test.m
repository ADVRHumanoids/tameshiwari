clearvars; close all; clc;


% 10CM AWAY FROM THE SINGULARITY
p_e = [0.90176, 0.000686027, 1.24463]'
pdot_e = [0.288391, -0.458663, -5.6322]'
omega_e = [1.54014, 10.4654, 0.480762]'

J_e =   [[-0.0240074, 0.166623, 0.169014], 
         [0.144664, 0.416364, 0.097376], 
         [-0.642438, 0.164814, -0.416866], 
         [0.492404, 0.640901, 0.348735], 
         [0.852869, -0.490284, 0.871432], 
         [0.173648, 0.590651, 0.344949]];

J_ts = J_e(1:3,:);

B_e =   [[1.17669, -0.115583, 0.487529], 
         [0, 0.857707, -0.00577066], 
         [0, 0, 0.330662]]

B_e = B_e + triu(B_e,1)'
factor = -2
mu = 10^(factor)*eye(3);

Lambda_e = inv(J_ts*inv(B_e)*J_ts' + mu)
h_e = Lambda_e * pdot_e
Lambda_e = inv(J_ts*inv(B_e)*J_ts')
h_e = Lambda_e * pdot_e


% AT THE SINGULARITY
p_e = [0.986867, 0.000761182, 1.23618]';
pdot_e = [-1.43377, -1.35668, -5.99259]'
omega_e = [3.69185, 9.75159, -1.91612]';

J_e =   [[-0.031228, 0.233519, -0.0679618], 
         [0.163604, 0.696038, 0.115266], 
         [-0.714986, 0.146149, -0.440364], 
         [0.492404, 0.0257143, 0.311952], 
         [0.852869, -0.21368, 0.929822], 
         [0.173648, 0.976565, 0.195238]];

J_ts = J_e(1:3,:);

B_e =   [[1.39993, -0.00539991, 0.606147], 
         [0, 1.45554, 0.00115905], 
         [0, 0, 0.330662]];

B_e = B_e + triu(B_e,1)';
mu = 10^(factor)*eye(3);

Lambda_e = inv(J_ts*inv(B_e)*J_ts' + mu)
h_e = Lambda_e * pdot_e
Lambda_e = inv(J_ts*inv(B_e)*J_ts')
h_e = Lambda_e * pdot_e
